# Reference
<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

**Classes**

_Public Classes_

* [`promtail`](#promtail): promtail's main interface. All interactions should be with this class.

_Private Classes_

* `promtail::config`: Creates files and folders associated with promtail's config
* `promtail::install`: Installs promtail
* `promtail::service`: Creates a service defintion for promtail

**Functions**

* [`promtail::to_yaml`](#promtailto_yaml): A function to convert a hash into yaml for the promtail config

## Classes

### promtail

promtail's main interface. All interactions should be with this class. The promtail
module is intended to install and configure Grafana's promtail tool for shipping
logs to Loki.

#### Examples

##### Config settings in Hiera

```puppet
include promtail
```

##### eyaml encrypted password in Hiera

```puppet
---
lookup_options:
  '^promtail::password_file_content$':
    convert_to: 'Sensitive'

promtail::password_file_content: ENC[PKCS7,MIIBasdfasdfasdfasdfasdfasdf==]
```

##### In-manifest config

```puppet
$config_hash = {
  'client'         => {
    'url'        => 'https://logs-us-west1.grafana.net/api/prom/push',
    'basic_auth' => {
      'username'      => '1234',
      'password_file' => '/etc/promtail/.gc_pw',
    },
  },
  'scrape_configs' => [
    {
      'job_name'       => 'system',
      'entry_parser'   => 'raw',
      'static_configs' => [
        {
          'targets' => [ 'localhost' ],
          'labels'  => {
            'job'      => 'var_log_messages',
            'host'     => $facts['networking']['fqdn'],
            '__path__' => '/var/log/messages',
          },
        },
      ],
    },
  ],
}

class { 'promtail':
  config_hash           => $config_hash,
  password_file_path    => '/etc/promtail/.gc_pw',
  password_file_content => Sensitive('myPassword'),
}
```

#### Parameters

The following parameters are available in the `promtail` class.

##### `config_hash`

Data type: `Hash`

A hash representing the configuration to be used by promtail.
See https://github.com/grafana/loki/blob/master/docs/clients/promtail/configuration.md#example-journal-config
for all paramters.

##### `bin_dir`

Data type: `Stdlib::Absolutepath`

The directory in which to create a symlink to the promtail binary

##### `checksum`

Data type: `String[1]`

The checksum of the promtail binary.
Note: each platform has its own checksum.
Values can be found with each release on GitHub

##### `version`

Data type: `String[1]`

The version as listed on the GitHub release page
See https://github.com/grafana/loki/releases for a list

##### `$password_file_path`

Data type: `Optional[Stdlib::Absolutepath]`

The fully qualified path to the file containing the password used for basic auth

##### `$password_file_content`

Data type: `Optional[Sensitive[String[1]]]`

The value to be placed in the password file.

##### `password_file_path`

Data type: `Optional[Stdlib::Absolutepath]`



Default value: `undef`

##### `password_file_content`

Data type: `Optional[Sensitive[String[1]]]`



Default value: `undef`

## Functions

### promtail::to_yaml

Type: Ruby 4.x API

A function to convert a hash into yaml for the promtail config

#### Examples

##### 

```puppet
promtail::to_yaml($promtail::config_hash)
```

#### `promtail::to_yaml(Hash $config_hash)`

A function to convert a hash into yaml for the promtail config

Returns: `String` Returns the YAML version of the hash as a string

##### Examples

###### 

```puppet
promtail::to_yaml($promtail::config_hash)
```

##### `config_hash`

Data type: `Hash`

A Puppet hash to be converted into YAML

